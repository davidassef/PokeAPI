<ion-header [translucent]="true">
  <ion-toolbar>
    <!-- Botão voltar (quando necessário) -->
    <ion-buttons slot="start" *ngIf="showBackButton">
      <ion-button fill="clear" (click)="goBack()" [attr.aria-label]="'nav.back' | translate">
        <ion-icon name="arrow-back-outline"></ion-icon>
        <span class="back-text">{{ 'nav.back' | translate }}</span>
      </ion-button>
    </ion-buttons>

    <!-- Título principal -->
    <ion-title>
      <div class="header-brand" *ngIf="!showBackButton">
        <div class="logo">🔥</div>
        <div class="brand-text">
          <h1>{{ title }}</h1>
          <p *ngIf="subtitle">{{ subtitle }}</p>
        </div>
      </div>
      <!-- Título simples para páginas internas -->
      <div class="simple-title" *ngIf="showBackButton">
        {{ title }}
      </div>
    </ion-title>

    <!-- Conteúdo customizado do slot end -->
    <ng-content select="[slot=end]"></ng-content>

    <!-- Utilitários do header (player + idioma) apenas em desktop -->
    <ion-buttons slot="end" class="header-utilities" [class.desktop-only]="!showBackButton">
      <!-- Player de Música Minimalista -->
      <div class="audio-player-minimal" *ngIf="isAudioEnabled" aria-label="Player de música da Pokédex">
        <!-- Botão Play/Pause -->
        <button
          class="player-btn play-pause"
          (click)="togglePlayPause()"
          [attr.aria-label]="isAudioPlaying ? 'Pausar música' : 'Tocar música'">
          {{ isAudioPlaying ? '⏸️' : '▶️' }}
        </button>

        <!-- Botão Restart -->
        <button
          class="player-btn restart"
          (click)="restartAudio()"
          aria-label="Reiniciar música">
          🔄
        </button>

        <!-- Controle de Volume com botões -->
        <div class="volume-control">
          <button class="volume-btn" (click)="decreaseVolume()" aria-label="Diminuir volume">🔉</button>
          <span class="volume-display">{{ audioVolume }}%</span>
          <button class="volume-btn" (click)="increaseVolume()" aria-label="Aumentar volume">🔊</button>
        </div>

        <!-- Indicador visual quando tocando -->
        <div class="playing-indicator" *ngIf="isAudioPlaying">
          <div class="pulse">🎵</div>
        </div>
      </div>

      <!-- Seletor de idioma -->
      <ion-button
        fill="clear"
        (click)="toggleLanguage()"
        class="nav-btn lang-btn">
        <ion-icon name="language-outline"></ion-icon>
        <span>{{ currentLanguage.toUpperCase() }}</span>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>
